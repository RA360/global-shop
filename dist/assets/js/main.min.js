"use strict";var searchBtn=document.querySelector("#searchBtn"),searchI=document.querySelector("#searchI"),suggests=document.querySelector("#suggests"),basketGoods=JSON.parse(localStorage.getItem("goods")),getCookie=function(a){var b=document.cookie.match(new RegExp("(?:^|; )".concat(a.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1"),"=([^;]*)")));return b?decodeURIComponent(b[1]):void 0};if(basketGoods&&(document.querySelector("#basketCount").textContent=basketGoods.length),!getCookie("city")&&navigator.geolocation){var showCityPopup=function(a){var b=document.createElement("div");b.className="city popup",b.id="city",b.innerHTML="<button class=\"city__close close\" id=\"cityClose\"></button>\n                     <div id=\"cityBox\">\n                       <p class=\"city__txt\">\n                         Your city \u2013 <span class=\"city__name\" id=\"cityName\">".concat(a,"?</span>\n                       </p>\n                       <div class=\"city__btns\">\n                         <button class=\"city__agree agree\" id=\"cityAgree\">Yes</button>\n                         <button class=\"city__another\" id=\"cityAnother\">Another city</button>\n                       </div>\n                       <p class=\"city__hint\">\n                         Availability of goods, methods and delivery time depend on the selected city.\n                       </p>\n                     </div>"),document.body.appendChild(b);var c=function(a){var b=new Date;b.setMonth(b.getMonth()+24),document.cookie="city=".concat(a,";expires=").concat(b)},d=function(){var a=document.querySelector("#city");a.classList.add("hide"),setTimeout(function(){a.remove()},1e3)},e=document.createElement("script");e.src="https://api-maps.yandex.ru/2.1/?lang=en_US&load=SuggestView",document.head.appendChild(e);var f=document.querySelector("#cityClose"),g=document.querySelector("#cityBox");document.querySelector("#cityAgree").addEventListener("click",function(){c(a),g.innerHTML="<p class=\"city__success city__txt\">\n                              Now you see goods with the availability, ways and delivery time for ".concat(a,"\n                            </p>");var b=setTimeout(function(){return d()},15e3);f.addEventListener("click",function(){return clearTimeout(b)})}),document.querySelector("#cityAnother").addEventListener("click",function(){g.innerHTML="<input class=\"city__input input\" id=\"cityI\" placeholder=\"Enter a city..\" />\n                             <p class=\"city__hint\">Click on suggestion.</p>";var a=new ymaps.SuggestView("cityI");a.events.add("select",function(a){c(a.get("item").value),d()})}),f.addEventListener("click",function(){c(a),d()})};navigator.geolocation.getCurrentPosition(function(a){fetch("https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=".concat(a.coords.latitude,"&longitude=").concat(a.coords.longitude)).then(function(a){return a.json()}).then(function(a){var b=a.locality;return showCityPopup(b)})},function(){fetch("https://ipinfo.io?token=f30c8c76005471").then(function(a){return a.json()}).then(function(a){var b=a.city;b&&showCityPopup(b)})})}if(!sessionStorage.getItem("cookie")){var cookie=document.createElement("div");cookie.className="cookie popup",cookie.innerHTML="<div>\n                        <p class=\"cookie__title\">Global Shop and Cookies</p>\n                        <p class=\"cookie__info\">This site uses cookies. By clicking ACCEPT or continuing to browse the site you are agreeing to our use of cookies. <a class=\"cookie__link\" href=\"https://ru.wikipedia.org/wiki/Cookie\" target=\"_blank\">Find out more here</a>.</p>\n                      </div>\n                      <button class=\"cookie__agree agree\" id=\"cookieAgree\">Accept</button>",document.body.appendChild(cookie),document.querySelector("#cookieAgree").addEventListener("click",function(a){a.target.parentNode.style.bottom="-999px",sessionStorage.setItem("cookie","accept"),setTimeout(function(){return a.target.parentNode.remove()},2e3)})}document.querySelector("#hamburger").addEventListener("click",function(){this.classList.toggle("open"),document.querySelector("#dropdown").classList.toggle("visible")}),searchBtn.addEventListener("click",function(){var a=document.querySelector("#title");suggests.textContent="",searchI.classList.toggle("visible"),a.classList.toggle("hidden");document.addEventListener("click",function b(c){c.target!=searchI&&c.target!=searchBtn&&(suggests.textContent="",searchI.classList.remove("visible"),a.classList.remove("hidden"),document.removeEventListener("click",b))})}),searchI.addEventListener("input",function(a){var b=a.target.value.trim();""!=b&&fetch("ajax/searchGoods",{method:"POST",body:b}).then(function(a){return a.text()}).then(function(a){return suggests.innerHTML=a})});